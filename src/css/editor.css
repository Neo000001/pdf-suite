/* --- Global Reset & Variables --- */
:root {
  --topbar-height: 60px;
  --sidebar-width: 70px;
  --accent-blue: #3b82f6;
  --bg-gray: #f9fafb;
  --border-gray: #e5e7eb;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body, html {
  height: 100%;
  font-family: 'Inter', system-ui, sans-serif;
  overflow: hidden; /* Main window doesn't scroll; workspace does */
}

/* --- Layout Structure --- */
.topbar {
  height: var(--topbar-height);
  background: #ffffff;
  border-bottom: 1px solid var(--border-gray);
  display: flex;
  align-items: center;
  padding: 0 20px;
  gap: 15px;
  z-index: 100;
}

.editor-root {
  display: flex;
  height: calc(100vh - var(--topbar-height));
}

.leftbar {
  width: var(--sidebar-width);
  background: #ffffff;
  border-right: 1px solid var(--border-gray);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 20px;
  gap: 15px;
}

.workspace {
  flex: 1;
  background: var(--bg-gray);
  overflow: auto; /* This allows the zoomed PDF to scroll */
  position: relative;
  display: flex;
  justify-content: center; /* Centers PDF horizontally */
}

/* --- The "Magic" Canvas Stack --- */
.canvas-wrapper {
  padding: 50px;
  display: inline-block; /* Essential for scrollbars to appear on zoom */
}

#canvas-inner {
  position: relative;
  background: white;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  transform-origin: top left; /* Critical for coordinate math */
}

/* Layer 1: The Original PDF (Static) */
#pdf-canvas {
  display: block;
  z-index: 1;
}

/* Layer 2: Pen, Highlighter, Eraser, Whiteout */
#draw-canvas {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  /* Pointer-events: auto/none is toggled in JS by setTool() */
}

/* Layer 3: Interactive Text Boxes and Signatures */
#overlay-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  pointer-events: none; /* Let clicks pass to draw-canvas unless a box is clicked */
}

/* --- UI Component Styling --- */
.tool-icon-btn {
  width: 45px;
  height: 45px;
  border: 1px solid transparent;
  background: transparent;
  border-radius: 8px;
  font-size: 1.2rem;
  cursor: pointer;
  transition: all 0.2s;
}

.tool-icon-btn:hover { background: #f3f4f6; }
.tool-icon-btn.active {
  background: #eff6ff;
  color: var(--accent-blue);
  border-color: var(--accent-blue);
}

.toolbar select, .toolbar input[type="range"] {
  padding: 5px;
  border-radius: 4px;
  border: 1px solid var(--border-gray);
}

/* --- Text Box Elements --- */
.text-box {
  position: absolute;
  min-width: 50px;
  min-height: 20px;
  padding: 4px;
  outline: none;
  cursor: text;
  pointer-events: auto; /* Overrides parent pointer-events: none */
  word-wrap: break-word;
  white-space: pre-wrap;
}

.text-box.selected {
  outline: 2px dashed var(--accent-blue);
  background: rgba(59, 130, 246, 0.05);
}

/* --- Modal & Other --- */
.hidden { display: none !important; }

#page-controls {
  position: fixed;
  bottom: 20px;
  background: rgba(31, 41, 55, 0.9);
  color: white;
  padding: 8px 16px;
  border-radius: 99px;
  z-index: 200;
}

#save-btn {
  background: var(--accent-blue);
  color: white;
  padding: 8px 20px;
  border-radius: 6px;
  font-weight: 600;
  border: none;
}

#save-btn:hover { background: #2563eb; }
